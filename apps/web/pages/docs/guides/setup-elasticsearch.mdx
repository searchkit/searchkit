---
title: Connecting to Elasticsearch
description: How to connect to Elasticsearch with Searchkit
---

The easiest way to connect to Elasticsearch is to use Elastic cloud. You can sign up for a free trial account and get started right away.

### Connecting to Elastic Cloud

To connect to Elastic Cloud, you need to create an account and get your credentials. You can do this by following the instructions on the [Elastic Cloud website](https://www.elastic.co/cloud).

Once you have setup a deployment, do the following:

1. Go to the [Elastic Cloud console](https://cloud.elastic.co/).
2. Click on the deployment you want to connect to.
3. Locate the Elasticsearch URL and copy it.
4. Paste the URL into the `connection.host` field in the configuration object, within the Node app.
5. Create an API key with `read` privileges for the index. Copy the API key and paste it into the `connection.apiKey` field in the configuration object, within the Node app. 

```ts
const client = Client({
  connection: {
    host: "ELASTICSEARCH_URL",
    apiKey: "API_KEY"
  }
})
```

#### (Required for browser-only Searchkit) Add CORS headers to your Elasticsearch deployment

If you are using Searchkit in the browser and without the node proxy, you will need to add CORS headers to your Elasticsearch instance.

To do this, you need to add the following to your `elasticsearch.yml` file:

```yaml
http.cors.allow-origin: "*"
http.cors.enabled: true
http.cors.allow-credentials: true
http.cors.allow-methods: OPTIONS, HEAD, GET, POST, PUT, DELETE
http.cors.allow-headers: X-Requested-With, X-Auth-Token, Content-Type, Content-Length, Authorization, Access-Control-Allow-Headers, Accept, x-elastic-client-meta
```

If Searchkit cannot connect to Elasticsearch, it will throw an error. You should be able to see the error in the terminal running the node API.

You can also switch on the `debug` [flag](/docs/api-documentation/api#debug-mode) in the configuration object, within the Node app, to see more detailed logs.

### Connecting to Elasticsearch locally

If you want to run Elasticsearch locally, you can download and install it from the [Elastic website](https://www.elastic.co/downloads/elasticsearch).

Once you have installed Elasticsearch, you can start it by running the following command in the terminal:

```bash
elasticsearch
```

You can then connect to Elasticsearch by setting the `connection.host` field in the configuration object, within the Node app, to `http://localhost:9200`.

API Key is not required but its important you use one for production.

```ts
const client = Client({
  connection: {
    host: "http://localhost:9200"
    auth: {
      username: "elastic",
      password: "changeme"
    }
  }
})
```

### Connecting to Elasticsearch with custom headers

If you are using Elasticsearch with a proxy, you may need to add custom headers to the request. You can do this by setting the `connection.headers` field in the configuration object, within the Node app.

```ts
const client = Client({
  connection: {
    host: "http://localhost:9200",
    headers: {
      "X-My-Header": "My-Value"
    }
  }
})
```

### Basic Auth with Elasticsearch

If you are using Elasticsearch with basic auth, you can set the `connection.auth.username` and `connection.auth.password` fields in the configuration object.

```ts
const client = Client({
  connection: {
    host: "http://localhost:9200",
    auth: {
      username: "elastic",
      password: "changeme"
    }
  }
})
```

### Custom Transport

Depending on your use case, you may be able to use the default transport with headers. If you need to use a custom transport, you can do so by implementing the `Transporter` interface.

```ts

import { ESTransporter } from 'searchkit'
import type { SearchRequest } from "searchkit"

class MyTransporter extends ESTransporter {
  async performNetworkRequest(requests: SearchRequest[]) {
    // you can use any http client here
    return fetch(`https://localhost:9200/_msearch`, {
      headers: {
        // Add custom headers here
      },
      body: this.createElasticsearchQueryFromRequest(requests),
      method: 'POST'
    })
  }
}

// then pass the custom transporter to the client
const client = Client({
  connection: new MyTransporter()
});
```

